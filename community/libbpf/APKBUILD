# Maintainer: Adam Jensen <acjensen@gmail.com>
pkgname=libbpf
pkgver=0.1.1
pkgrel=1
pkgdesc="A library for interacting with the Linux kernel's Berkeley Packet Filter (BPF) facility from user space"
url="https://github.com/libbpf/libbpf"
arch="all"
license="GPL-2.0-only"
# No test suite
options="!check"
depends="elfutils"
makedepends="build-base linux-headers elfutils-dev zlib-dev"
subpackages="$pkgname-dev"
source="$pkgname-$pkgver.tar.gz::https://github.com/libbpf/libbpf/archive/v$pkgver.tar.gz
	10-consolidate-lib-dirs.patch"

build() {
	cd src
	make NO_PKG_CONFIG=1
}

package() {
	cd src
	make install DESTDIR="$pkgdir"
	cp -R "$builddir/include/uapi" "$pkgdir/usr/include/uapi"
}

sha512sums="b9f68323a8f53b0fb0bf418b8a37685e7d74b6f5ad7aa2f266f65cd57199b3b9b5865bc4579758e5adcfbb027ced83e12ee87f3ff3bf159c7b54cbdcd50fd62f  libbpf-0.1.1.tar.gz
1f19209278f7feaee27a8211f11851c3fe601e5a5c548c8b1bcf1aae7e17c0fe2933e07a3b5b38115c940949ca4c30ad669c618bad69fe2b3d8d1a4d91fecc1b  10-consolidate-lib-dirs.patch"
